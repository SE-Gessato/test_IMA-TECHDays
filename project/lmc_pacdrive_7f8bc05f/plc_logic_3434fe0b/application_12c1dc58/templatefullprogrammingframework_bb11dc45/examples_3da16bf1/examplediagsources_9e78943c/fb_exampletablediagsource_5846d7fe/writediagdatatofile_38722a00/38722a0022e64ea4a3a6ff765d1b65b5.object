{"payload":{"meta":{"Graph":{"@Type":"81297157","@Value":{"Guid":"(Guid)38722a00-22e6-4ea4-a3a6-ff765d1b65b5","ParentGuid":"(Guid)5846d7fe-4477-4e09-84a2-7fc70664d6a7","Name":"(string)WriteDiagDataToFile","Properties":{"@Type":"2c41fa04:IDictionary","@Value":{}},"TypeGuid":"(Guid)f8a58466-d7f6-439f-bbb8-d4600e41d099","EmbeddedTypeGuids":{"@Type":"[Guid]","@Value":["(Guid)a9ed5b7e-75c5-4651-af16-d2c27e98cb94","(Guid)3b83b776-fb25-43b8-99f2-3c507c9143fc"]}}},"TypeInfos":{"2c41fa04":"{2c41fa04-1834-41c1-816e-303c7aa2c05b}","81297157":"{81297157-7ec9-45ce-845e-84cab2b88ade}","Guid":"System.Guid","string":"System.String"}},"object":{"Graph":{"@Type":"f8a58466","@Value":{"Implementation":{"@Type":"3b83b776","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string)TPL.FC_CanContinueWriting(iq_stCanContinueWriting := THIS^.iq_stComStructure.iq_stCanContinueWriting); (* loop as long as we can continue to write *)\n\nWHILE (THIS^.iq_stComStructure.iq_stCanContinueWriting.xCanContinue) DO\n\t\n\tCASE THIS^.diCmdExecState OF\n\t\t1:\n\t\t\t(* start writing *)\n\t\t\tTHIS^.fbTableWriter.HeaderStart(\ti_sName\t\t\t\t\t:= THIS^.c_sName, \n\t\t\t\t\t\t\t\t\t\t\t\ti_sTypeName\t\t\t\t:= THIS^.c_sTypeName, \n\t\t\t\t\t\t\t\t\t\t\t\ti_sTitleEnglish\t\t\t:= 'Example Data as Table', \n\t\t\t\t\t\t\t\t\t\t\t\ti_sTitleGerman\t\t\t:= 'Beispieldaten als Tabelle', \n\t\t\t\t\t\t\t\t\t\t\t\ti_uiPrintRank\t\t\t:= 14, \n\t\t\t\t\t\t\t\t\t\t\t\ti_sEmptyListTextEnglish\t:= 'No data available to show', \n\t\t\t\t\t\t\t\t\t\t\t\ti_sEmptyListTextGerman\t:= 'Keine Daten zum Anzeigen vorhanden',\n\t\t\t\t\t\t\t\t\t\t\t\tq_etDiag\t\t\t\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t\t\t\t=> THIS^.etDiagExtTPL);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\tExceptionDuringWriting();\n\t\t\t\tEXIT;\n\t\t\tEND_IF\n\t\t\t\n\t\t\tTHIS^.udiCName := THIS^.fbTableWriter.HeaderAddColumn(\ti_sName\t\t\t:= 'Name',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ti_sTextEnglish\t:= 'Name',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ti_sTextGerman\t:= 'Name',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ti_uiWidth\t\t:= 120,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tq_etDiag\t\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t\t=> THIS^.etDiagExtTPL);\n\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\tExceptionDuringWriting();\n\t\t\t\tEXIT;\n\t\t\tEND_IF\n\n\t\t\tTHIS^.udiCValue := THIS^.fbTableWriter.HeaderAddColumn(\ti_sName\t\t\t:= 'Value',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ti_sTextEnglish\t:= 'Value',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ti_sTextGerman\t:= 'Wert',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ti_uiWidth\t\t:= 120,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tq_etDiag\t\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t\t=> THIS^.etDiagExtTPL);\n\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\tExceptionDuringWriting();\n\t\t\t\tEXIT;\n\t\t\tEND_IF\n\n\t\t\tTHIS^.udiCC3 := THIS^.fbTableWriter.HeaderAddColumn(i_sName\t\t\t:= 'Column3',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ti_sTextEnglish\t:= 'Column3',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ti_sTextGerman\t:= 'Spalte3',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ti_uiWidth\t\t:= 120,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tq_etDiag\t\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t\t=> THIS^.etDiagExtTPL);\n\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\tExceptionDuringWriting();\n\t\t\t\tEXIT;\n\t\t\tEND_IF\n\n\t\t\tIF THIS^.udiCC3 <= 0 OR THIS^.udiCValue <= 0 OR THIS^.udiCName <= 0 THEN\n\n\t\t\t\tTHIS^.etDiag\t\t:= GD.ET_Diag.ExecutionAborted;\n\t\t\t\tTHIS^.etDiagExtTPL\t:= TPL.ET_DiagExt.HeaderColumnIdInvalid;\n\n\t\t\t\tExceptionDuringWriting();\n\t\t\t\tEXIT;\n\t\t\tEND_IF\n\n\t\t\tTHIS^.fbTableWriter.HeaderFinish(\tq_etDiag\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t=> THIS^.etDiagExtTPL);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\tExceptionDuringWriting();\n\t\t\t\tEXIT;\n\t\t\tEND_IF\n\n\t\t\tTHIS^.udiRowCounter := 1; (* start loop at index 1 *)\n\n\t\t\tTHIS^.diCmdExecState := THIS^.diCmdExecState + 1;\n\t\t\t\n\t\t2:\t(* loop over all rows *)\n\n\t\t\tIF (THIS^.udiRowCounter <= THIS^.c_udiMaxNumRows) THEN\n\t\t\t\t\n\t\t\t\t(* write row *)\n\t\t\t\tTHIS^.fbTableWriter.RowStart(\tq_etDiag\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t=> THIS^.etDiagExtTPL);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\t\tExceptionDuringWriting();\n\t\t\t\t\tEXIT;\n\t\t\t\tEND_IF\n\t\t\t\t\n\t\t\t\t(* write values *)\n\t\t\t\tTHIS^.fbTableWriter.RowValue(\ti_udiColumnNumber\t:= THIS^.udiCName, \n\t\t\t\t\t\t\t\t\t\t\t\ti_sValue\t\t\t:= CONCAT('name_',UDINT_TO_STRING(udiRowCounter)),\n\t\t\t\t\t\t\t\t\t\t\t\tq_etDiag\t\t\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t\t\t=> THIS^.etDiagExtTPL);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\t\tExceptionDuringWriting();\n\t\t\t\t\tEXIT;\n\t\t\t\tEND_IF\n\n\t\t\t\tTHIS^.fbTableWriter.RowValue(\ti_udiColumnNumber\t:= THIS^.udiCValue, \n\t\t\t\t\t\t\t\t\t\t\t\ti_sValue\t\t\t:= LREAL_TO_STRING((8000.0 - UDINT_TO_LREAL(udiRowCounter))/5),\n\t\t\t\t\t\t\t\t\t\t\t\tq_etDiag\t\t\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t\t\t=> THIS^.etDiagExtTPL);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\t\tExceptionDuringWriting();\n\t\t\t\t\tEXIT;\n\t\t\t\tEND_IF\n\n\t\t\t\tTHIS^.fbTableWriter.RowValue(\ti_udiColumnNumber\t:= THIS^.udiCC3, \n\t\t\t\t\t\t\t\t\t\t\t\ti_sValue\t\t\t:= UDINT_TO_STRING(udiRowCounter + 88),\n\t\t\t\t\t\t\t\t\t\t\t\tq_etDiag\t\t\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t\t\t=> THIS^.etDiagExtTPL);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\t\tExceptionDuringWriting();\n\t\t\t\t\tEXIT;\n\t\t\t\tEND_IF\n\t\t\t\t\n\t\t\t\tTHIS^.fbTableWriter.RowEnd(\tq_etDiag\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t=> THIS^.etDiagExtTPL);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\t\tExceptionDuringWriting();\n\t\t\t\t\tEXIT;\n\t\t\t\tEND_IF\n\t\t\tEND_IF\n\n\t\t\tTHIS^.iq_stComStructure.q_lrProgress := UDINT_TO_LREAL(THIS^.udiRowCounter) * LREAL#100.0 / MAX(UDINT_TO_LREAL(THIS^.c_udiMaxNumRows), LREAL#0.0001);\n\n\t\t\tTHIS^.udiRowCounter := THIS^.udiRowCounter + 1;\n\t\t\tIF (THIS^.udiRowCounter > THIS^.c_udiMaxNumRows) THEN\n\t\t\t\t(* loop over all rows done *)\n\t\t\t\tTHIS^.diCmdExecState := THIS^.diCmdExecState + 1;\n\t\t\tEND_IF\n\t\t3:\n\t\t\tTHIS^.fbTableWriter.TableEnd(\tq_etDiag\t=> THIS^.etDiag,\n\t\t\t\t\t\t\t\t\t\t\tq_etDiagExt\t=> THIS^.etDiagExtTPL);\n\t\t\t\t\t\t\t\t\t\n\t\t\tIF THIS^.etDiag <> GD.ET_Diag.Ok THEN\n\t\t\t\tExceptionDuringWriting();\n\t\t\t\tEXIT;\n\t\t\tEND_IF\n\t\t\t\n\t\t\t(* done *)\n\t\t\tTHIS^.iq_stComStructure.iq_diCmd := 0;\n\n\t\t\tSetDiagOutputs(\ti_etDiag\t:= GD.ET_Diag.Ok,\n\t\t\t\t\t\t\ti_etDiagExt\t:= ET_DiagExt.DataSuccessfullyWritten,\n\t\t\t\t\t\t\ti_sMsg\t\t:= '');\t\t\t\t\t\n\t\n\t\t\tTHIS^.diCmdExecState := 0;\n\t\t\tEXIT; (* exit the while loop *)\n\tEND_CASE\n\t\n\t(* check again whether we can continue writing *)\n\tTPL.FC_CanContinueWriting(iq_stCanContinueWriting := THIS^.iq_stComStructure.iq_stCanContinueWriting);\nEND_WHILE","LineInfoPersistence":"(string)38722a00-22e6-4ea4-a3a6-ff765d1b65b5_Impl_LineIds"}}}},"Interface":{"@Type":"a9ed5b7e","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string){attribute 'hide'}\nMETHOD WriteDiagDataToFile : BOOL\nVAR_INPUT\nEND_VAR\n","LineInfoPersistence":"(string)38722a00-22e6-4ea4-a3a6-ff765d1b65b5_Decl_LineIds"}}}}}},"TypeInfos":{"3b83b776":"{3b83b776-fb25-43b8-99f2-3c507c9143fc}","a9ed5b7e":"{a9ed5b7e-75c5-4651-af16-d2c27e98cb94}","f3878285":"{f3878285-8e4f-490b-bb1b-9acbb7eb04db}","f8a58466":"{f8a58466-d7f6-439f-bbb8-d4600e41d099}","string":"System.String"}}},"FormatVersion":"1.0"}