{"payload":{"meta":{"Graph":{"@Type":"81297157","@Value":{"Guid":"(Guid)159ba18c-c881-4467-bd05-0b740d3f7fe9","ParentGuid":"(Guid)a8736412-820a-458d-a88c-f60de058aebb","Name":"(string)ModuleNavigationOut","Properties":{"@Type":"2c41fa04:IDictionary","@Value":{}},"TypeGuid":"(Guid)8ac092e5-3128-4e26-9e7e-11016c6684f2","EmbeddedTypeGuids":{"@Type":"[Guid]","@Value":["(Guid)3b83b776-fb25-43b8-99f2-3c507c9143fc"]}}},"TypeInfos":{"2c41fa04":"{2c41fa04-1834-41c1-816e-303c7aa2c05b}","81297157":"{81297157-7ec9-45ce-845e-84cab2b88ade}","Guid":"System.Guid","string":"System.String"}},"object":{"Graph":{"@Type":"8ac092e5","@Value":{"Implementation":{"@Type":"3b83b776","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string)(* update 2d nav data *)\nvpq_sNameNavUp\t\t:= '';\nvpq_sNameNavRight\t:= '';\nvpq_sNameNavLeft\t\t:= '';\n\nIF pstCurrentParent = 0 THEN\n\tudiCurrentLevelSize := 1;\nELSE\n\tudiCurrentLevelSize := pstCurrentParent^.iq_stExt.udiNumberOfSubModules;\n\n\tvpq_sNameNavUp := pstCurrentParent^.i_sModuleName;\n\t(*If next module is a equipment module*)\n\tIF (audiHierarchy[udiCurrentLevel] + 1 <= udiCurrentLevelSize) THEN\n\t\tpstTmp := pstCurrentParent^.iq_stExt.dwSubModulesItf\n\t\t\t+ UDINT_TO_DWORD((audiHierarchy[udiCurrentLevel] -1 + 1) * SIZEOF(vpq_stCurrentModuleStandardInterface));\n\t\tvpq_sNameNavRight := pstTmp^.i_sModuleName;\n\t(*If next module is a control module*)\n\tELSIF audiHierarchy[udiCurrentLevel] + 1 <= udiCurrentLevelSize + pstCurrentParent^.iq_stExt.udiNumberOfControlModules THEN\n\t\tpstControlModuleInterface\t:= pstCurrentParent^.iq_stExt.dwControlModulesItf + UDINT_TO_DWORD((audiHierarchy[udiCurrentLevel]-udiCurrentLevelSize) * SIZEOF(pstControlModuleInterface^));\n\t\tvpq_sNameNavRight\t\t\t:= pstControlModuleInterface^.sControlModuleName;\n\tEND_IF\n\tIF (audiHierarchy[udiCurrentLevel] -1 >= 1) THEN\n\t\t(*If former module is a equipment module*)\n\t\tIF audiHierarchy[udiCurrentLevel]-1 <= udiCurrentLevelSize THEN\n\t\t\tpstTmp := pstCurrentParent^.iq_stExt.dwSubModulesItf\n\t\t\t\t+ UDINT_TO_DWORD((audiHierarchy[udiCurrentLevel] -1 - 1) * SIZEOF(vpq_stCurrentModuleStandardInterface));\n\t\t\tvpq_sNameNavLeft := pstTmp^.i_sModuleName;\n\t\t(*If former module is a control module*)\n\t\tELSE\n\t\t\tpstControlModuleInterface\t:= pstCurrentParent^.iq_stExt.dwControlModulesItf + UDINT_TO_DWORD((audiHierarchy[udiCurrentLevel]-udiCurrentLevelSize-2) * SIZEOF(pstControlModuleInterface^));\n\t\t\tvpq_sNameNavLeft\t\t\t\t:= pstControlModuleInterface^.sControlModuleName;\n\t\tEND_IF\n\tEND_IF\nEND_IF\n\nxCurrentHasControlModules := pstCurrent^.iq_stExt.udiNumberOfControlModules > 0;\nxCurrentHasSubModules := ((pstCurrent^.iq_stExt.udiNumberOfSubModules > 0) AND udiControlModuleSelectedInLevel = 0);\nxCurrentIsNoNodeModule := (pstCurrent^.q_dwModuleType <>  UDINT_TO_DWORD(TPL.ET_ModuleType.NodeModule));\nIF((xCurrentIsNoNodeModule OR xCurrentHasControlModules) AND udiControlModuleSelectedInLevel = 0) THEN\n\tIF(pstCurrentParent <> 0) THEN (* Security check *)\n\t\tpdwTmp := ADR(pstCurrentParent^.iq_stExt.pdwSubModulesAddItf^)\n\t\t\t+  UDINT_TO_DWORD((audiHierarchy[udiCurrentLevel] - 1) * SIZEOF(dwDummy));\n\t\tdwCurrentAddInterface := pdwTmp^;\n\tEND_IF\nEND_IF\n\nvpq_xEnableNavUp\t\t:= (udiCurrentLevel - 1 >= 1);\nvpq_xEnableNavDown\t:= (udiCurrentLevel < c_udiMaxHierarchyLevels) AND (xCurrentHasSubModules OR xCurrentHasControlModules) AND udiControlModuleSelectedInLevel = 0 ;\nvpq_xEnableNavLeft\t:= (audiHierarchy[udiCurrentLevel] -1 >= 1);\nvpq_xEnableNavRight\t:= (audiHierarchy[udiCurrentLevel] + 1 <= udiCurrentLevelSize + udiCurrentNumberOfControlModules)AND(udiCurrentLevel >=2);\n\nIF vpq_xEnableNavDown THEN\n\t(* Name of the first submodule of the current module *)\n\tIF xCurrentHasSubModules THEN\n\t\tpstTmp := pstCurrent^.iq_stExt.dwSubModulesItf;\n\t\tvpq_sNameNavDown := pstTmp^.i_sModuleName;\n\tELSE\n\t\tpstControlModuleInterface\t:= pstCurrent^.iq_stExt.dwControlModulesItf;\n\t\tvpq_sNameNavDown\t\t\t\t:= pstControlModuleInterface^.sControlModuleName;\n\tEND_IF\n\nELSE\n\tvpq_sNameNavDown := '';\nEND_IF\n\n(* Update direct nav data *)\n(* Module level *)\nvpq_xDisableModuleListDown\t:= NOT (udiMinModuleList > 1);\nvpq_xDisableModuleListUp\t\t:= NOT (udiMinModuleList + 5 <= vpq_stMachineInterface.iq_stExt.udiNumberOfSubModules + vpq_stMachineInterface.iq_stExt.udiNumberOfControlModules);\nFOR udiTmp := 1 TO 5 DO\n\tvpq_axControlModuleValid[udiTmp]:=FALSE;\n\taudiControlModuleNumber[udiTmp]:= 0 (*-1*);\n\tvpq_asToolTipControlModuleList[udiTmp] := 'None';\n\tvpq_axDisableModuleList[udiTmp] := NOT ((udiTmp - 1 + udiMinModuleList) <= vpq_stMachineInterface.iq_stExt.udiNumberOfSubModules);\n\tvpq_axActiveModuleList[udiTmp] := (udiCurrentLevel >= 2) AND (audiHierarchy[2] = (udiTmp - 1 + udiMinModuleList));\n\tvpq_axControlModuleActive[udiTmp] := FALSE;\n\t(*Show button for equipment module*)\n\tIF(NOT vpq_axDisableModuleList[udiTmp]) THEN\n\t\tpstTmp := vpq_stMachineInterface.iq_stExt.dwSubModulesItf\n\t\t\t+ UDINT_TO_DWORD(((udiTmp - 1 + udiMinModuleList) - 1) * SIZEOF(vpq_stCurrentModuleStandardInterface));\n\t\tvpq_audiIdModuleList[udiTmp] := pstTmp^.i_udiModuleId;\n\t\tvpq_axIdModuleListValid[udiTmp] := TRUE;\n\t\t\n\t\tvpq_asNameModuleList[udiTmp] := pstTmp^.i_sModuleName;\n\t(*Show button for control module*)\n\tELSE\n\t\tvpq_audiIdModuleList[udiTmp] := 0 (*-1*);\n\t\tvpq_axIdModuleListValid[udiTmp] := FALSE;\n\t\tvpq_asNameModuleList[udiTmp] := 'None';\n\t\tIF vpq_stMachineInterface.iq_stExt.udiNumberOfControlModules <> 0 AND udiTmp <= vpq_stMachineInterface.iq_stExt.udiNumberOfControlModules + vpq_stMachineInterface.iq_stExt.udiNumberOfSubModules THEN\n\t\t\tpstControlModuleInterface\t:= vpq_stMachineInterface.iq_stExt.dwControlModulesItf + UDINT_TO_DWORD((udiTmp - vpq_stMachineInterface.iq_stExt.udiNumberOfSubModules - 1 + udiMinModuleList)-1) * SIZEOF(pstControlModuleInterface^);\n\t\t\tvpq_asToolTipControlModuleList[udiTmp]:= pstControlModuleInterface^.sControlModuleName;\n\t\t\tvpq_axControlModuleActive[udiTmp] := (udiCurrentLevel >= 2) AND (audiHierarchy[2] = (udiTmp - 1 + udiMinModuleList));\n\t\t\tvpq_axControlModuleValid[udiTmp]:=TRUE;\n\t\t\taudiControlModuleNumber[udiTmp]:= pstControlModuleInterface^.udiControlModuleNumber;\n\t\t\tvpq_asControlModuleButtonName[udiTmp]:= CONCAT(STR1:='Type: ',STR2:= CONCAT(STR1:= UDINT_TO_STRING(pstControlModuleInterface^.udiControlModuleType), STR2:= CONCAT(STR1:='   #: ',STR2:= UDINT_TO_STRING(pstControlModuleInterface^.udiControlModuleNumber))));\n\t\tEND_IF\n\tEND_IF\nEND_FOR\n\n(* Submodule level *)\nIF (udiMinSubModuleList + 4 > udiCurrentLevel3Size+udiNumberOfControlModulesLevel2) THEN\n\tudiMinSubModuleList := 1;\nEND_IF\nvpq_xDisableSubModuleListDown\t:= NOT (udiMinSubModuleList > 1);\nvpq_xDisableSubModuleListUp\t\t:= NOT (udiMinSubModuleList + 5 <= udiCurrentLevel3Size+udiNumberOfControlModulesLevel2)AND NOT (udiCurrentLevel = 2 AND xControlModuleSelected);\nFOR udiTmp := 1 TO 5 DO\n\tvpq_axDisableSubModuleList[udiTmp] := NOT ((udiTmp - 1 + udiMinSubModuleList) <= udiCurrentLevel3Size);\n\tvpq_axActiveSubModuleList[udiTmp] := (udiCurrentLevel >= 3) AND (audiHierarchy[3] = (udiTmp - 1 + udiMinSubModuleList));\n\tvpq_audiIdSubModuleList[udiTmp] := 0 (*-1*);\n\tvpq_axIdSubModuleListValid[udiTmp] := FALSE;\n\tvpq_asNameSubModuleList[udiTmp] := 'None';\n\tvpq_axSubControlModuleValid[udiTmp]:= FALSE;\n\taudiSubControlModuleID[udiTmp]:= 0 (*-1*);\n\tvpq_asToolTipSubControlModuleList[udiTmp] := 'None';\n\tvpq_axSubControlModuleActive[udiTmp] := FALSE;\n\t(*Show button for equipment module*)\n\tIF(NOT vpq_axDisableSubModuleList[udiTmp]) THEN\n\t\tIF(pstCurrentFirstLevel3Module <> 0) THEN\n\t\t\tpstTmp := ADR(pstCurrentFirstLevel3Module^)\n\t\t\t\t+  UDINT_TO_DWORD(((udiTmp - 1 + udiMinSubModuleList) - 1) * SIZEOF(vpq_stCurrentModuleStandardInterface));\n\t\t\tvpq_audiIdSubModuleList[udiTmp] := pstTmp^.i_udiModuleId;\n\t\t\tvpq_axIdSubModuleListValid[udiTmp] := TRUE;\n\t\t\t\n\t\t\tvpq_asNameSubModuleList[udiTmp] := pstTmp^.i_sModuleName;\n\t\tEND_IF\n\t(*Show button for control module*)\n\tELSE\n\t\tIF udiCurrentLevel >= 2 AND udiControlModuleSelectedInLevel <> 2 THEN\n\t\t\tIF pstCurrentLevel2 <> 0 THEN\n\t\t\t\tIF pstCurrentLevel2^.iq_stExt.udiNumberOfControlModules <> 0 AND udiTmp <= pstCurrentLevel2^.iq_stExt.udiNumberOfControlModules + udiCurrentLevel3Size THEN\n\t\t\t\t\tpstControlModuleInterface\t:= pstCurrentLevel2^.iq_stExt.dwControlModulesItf + UDINT_TO_DWORD((udiTmp - pstCurrentLevel2^.iq_stExt.udiNumberOfSubModules - 1 + udiMinSubModuleList - 1) * SIZEOF(pstControlModuleInterface^));\n\t\t\t\t\tvpq_asToolTipSubControlModuleList[udiTmp]:= pstControlModuleInterface^.sControlModuleName;\n\t\t\t\t\tvpq_asSubControlModuleButtonName[udiTmp]:= CONCAT(STR1:='Type: ',STR2:= CONCAT(STR1:= UDINT_TO_STRING(pstControlModuleInterface^.udiControlModuleType), STR2:= CONCAT(STR1:='   #: ',STR2:= UDINT_TO_STRING(pstControlModuleInterface^.udiControlModuleNumber))));\n\t\t\t\t\tvpq_axSubControlModuleActive[udiTmp] :=  (udiCurrentLevel >= 3) AND (audiHierarchy[3] = (udiTmp - 1 + udiMinSubModuleList));\n\t\t\t\t\tvpq_axSubControlModuleValid[udiTmp]:= TRUE;\n\t\t\t\t\taudiSubControlModuleID[udiTmp]:= pstControlModuleInterface^.udiControlModuleNumber;\n\t\t\t\tEND_IF\n\t\t\tEND_IF\n\t\tEND_IF\n\tEND_IF\nEND_FOR\n\n// iEQTableIndexMin := 1;\n//iEQTableIndexOld := 0;\n\n(*Select current control module*)\nFOR udiTmp := 1 TO 5 DO\n\tIF vpq_axControlModuleActive[udiTmp] THEN\n\t\tvpq_udiActiveControlModuleNumber:= audiControlModuleNumber[udiTmp];\n\tEND_IF\n\tIF vpq_axSubControlModuleActive[udiTmp] THEN\n\t\tvpq_udiActiveControlModuleNumber:= audiSubControlModuleID[udiTmp];\n\tEND_IF\nEND_FOR","LineInfoPersistence":"(string)159ba18c-c881-4467-bd05-0b740d3f7fe9_Impl_LineIds"}}}},"UniqueIdGenerator":"(string)313"}},"TypeInfos":{"3b83b776":"{3b83b776-fb25-43b8-99f2-3c507c9143fc}","8ac092e5":"{8ac092e5-3128-4e26-9e7e-11016c6684f2}","f3878285":"{f3878285-8e4f-490b-bb1b-9acbb7eb04db}","string":"System.String"}}},"FormatVersion":"1.0"}