{"payload":{"meta":{"Graph":{"@Type":"81297157","@Value":{"Guid":"(Guid)7db2c0a8-f08d-478e-af71-421c107feedc","ParentGuid":"(Guid)f991b686-ef94-4c48-a8c3-6503f888c82a","Name":"(string)Check_RTB","Properties":{"@Type":"2c41fa04:IDictionary","@Value":[{"@Key":"(Guid)24568a24-c491-472c-a21f-ee5d33859fab","@Value":{"@Type":"24568a24","@Value":{"MemoryReserveForOnlineChange":"(int)0","ExcludeFromBuild":"(bool)False","External":"(bool)False","EnableSystemCall":"(bool)False","CompilerDefines":"(string)","LinkAlways":"(bool)False","Undefines":{"@Type":"[string]","@Value":[]}}}},{"@Key":"(Guid)829a18f2-c514-4f6e-9634-1df173429203","@Value":{"@Type":"829a18f2","@Value":{"ParentObjects":{"@Type":"fa2ee218:IDictionary","@Value":[{"@Key":"(Guid)d9b2b2cc-ea99-4c3b-aa42-1e5c49e65b84","@Value":"(Guid)365a9a45-5988-40bc-be63-8d2ba66e0f53"}]}}}}]},"TypeGuid":"(Guid)8ac092e5-3128-4e26-9e7e-11016c6684f2","EmbeddedTypeGuids":{"@Type":"[Guid]","@Value":["(Guid)3b83b776-fb25-43b8-99f2-3c507c9143fc"]}}},"TypeInfos":{"24568a24":"{24568a24-c491-472c-a21f-ee5d33859fab}","2c41fa04":"{2c41fa04-1834-41c1-816e-303c7aa2c05b}","81297157":"{81297157-7ec9-45ce-845e-84cab2b88ade}","829a18f2":"{829a18f2-c514-4f6e-9634-1df173429203}","bool":"System.Boolean","fa2ee218":"{fa2ee218-a39b-4b6d-b249-49dbddbd168a}","Guid":"System.Guid","int":"System.Int32","string":"System.String"}},"object":{"Graph":{"@Type":"8ac092e5","@Value":{"Implementation":{"@Type":"3b83b776","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string)(*\ncheck RTB State\nIf RTB failure, all axis modules will be disabled.\nAfter restart RTB, then all axis modules will be enabled again and the axes positions will be restored.\nafter home ok, opmode could be selected \n*)\n(*########################################################################################*)\n\n(* check RTB failure *)\nIF Sercos_Master.State <> 4\nAND NOT xRTBFailureFlag THEN\n\n\txRTBFailureFlag := TRUE;\n\t\n\t\t(* disable axes modules *)\n\t\tFOR udiCount := 1 TO c_udiNumberOfSubModules DO\n\t\t\t\n\t\t\t(* axis module detection *)\n\t\t\tIF astSubModuleInterface[udiCount].q_dwModuleType = TPL.ET_ModuleType.AxisModule THEN\n\t\t\t\tastSubModuleInterface[udiCount].i_xEnable \t\t:= FALSE;\t(* disable axes modules *)\n\t\t\tEND_IF\n\t\tEND_FOR\n\t\t\n\t\tdiStateRTB := 10;\n\nELSIF Sercos_Master.State = 4 THEN\t(* RTB ok *)\n\txRTBFailureFlag := FALSE;\nEND_IF\n\n(************************************************************************************************************************)\n\tCASE diStateRTB OF\n\n\t0:;\t(* wait *)\n\n\t10:\t(* wait for restart RTB *)\n\n\t\tIF Sercos_Master.State > 0\n\t\tAND Sercos_Master.State  <> 4 THEN\n\t\t\txReInit\t\t\t\t\t\t\t\t := TRUE;\t\t(* set marker reinit active *)\n\t\t\tdiStateRTB := 20;\n\t\tEND_IF\n\n\t20:\t(* wait for RTB ready and ErrorQuit. / wait till AxesModules are disabled / --> restart axes modules *)\n\t\tFOR udiCount := 1 TO c_udiNumberOfSubModules DO\n\t\t\t\n\t\t\t(* axis module detection *)\n\t\t\tIF astSubModuleInterface[udiCount].q_dwModuleType = TPL.ET_ModuleType.AxisModule THEN\n\t\t\t\tIF astSubModuleInterface[udiCount].q_xActive THEN\t(* module active *)\n\t\t\t\t\txModulesNotActive \t\t\t\t\t\t\t:= FALSE;\n\t\t\t\t\tEXIT;\n\t\t\t\tELSIF NOT astSubModuleInterface[udiCount].q_xActive THEN\t(* module not active *)\n\t\t\t\t\txModulesNotActive \t\t\t\t\t\t\t:= TRUE;\n\t\t\t\tEND_IF\n\t\t\tEND_IF\n\t\tEND_FOR\n\n\t\tIF Sercos_Master.State = 4\n\t\tAND xModulesNotActive\n\t\tAND iq_stStandardModuleItf.i_xDiagQuit THEN\n\t\t\n\t\t\tFOR udiCount := 1 TO c_udiNumberOfSubModules DO\n\t\t\t\t(* axis module detection *)\n\t\t\t\tIF astSubModuleInterface[udiCount].q_dwModuleType = TPL.ET_ModuleType.AxisModule THEN\n\t\t\t\t\tastSubModuleInterface[udiCount].i_xEnable\t := TRUE;\t(* enable axes modules *)\n\t\t\t\tEND_IF\n\t\t\tEND_FOR\n\t\t\tdiStateRTB := 30;\n\t\tEND_IF\n\n\t30:\t(* wait for axes modules active *)\n\n\t\tFOR udiCount := 1 TO c_udiNumberOfSubModules DO\n\t\t\t\n\t\t\t(* axis module detection *)\n\t\t\tIF astSubModuleInterface[udiCount].q_dwModuleType = TPL.ET_ModuleType.AxisModule THEN\n\t\t\t\tIF NOT astSubModuleInterface[udiCount].q_xActive THEN\t(* module not active *)\n\t\t\t\t\txModulesActive \t\t\t\t\t\t\t\t:= FALSE;\n\t\t\t\t\tEXIT;\n\t\t\t\tELSIF astSubModuleInterface[udiCount].q_xActive THEN\t(* module active *)\n\t\t\t\t\txModulesActive \t\t\t\t\t\t\t\t:= TRUE;\n\t\t\t\tEND_IF\n\t\t\tEND_IF\n\t\tEND_FOR\n\n\t\tIF xModulesActive THEN\t(* all axis modules active *)\n\t\t\tdiStateRTB := 40;\n\t\tEND_IF\n\n\t40:\t(* Reinit ready  *)\n\n\t\txReInit\t\t\t\t\t\t\t\t\t:= FALSE;\t\t(* reset marker reinit active *)\n\t\tdiStateRTB := 0;\n\n\tEND_CASE","LineInfoPersistence":"(string)7db2c0a8-f08d-478e-af71-421c107feedc_Impl_LineIds"}}}},"UniqueIdGenerator":"(string)196"}},"TypeInfos":{"3b83b776":"{3b83b776-fb25-43b8-99f2-3c507c9143fc}","8ac092e5":"{8ac092e5-3128-4e26-9e7e-11016c6684f2}","f3878285":"{f3878285-8e4f-490b-bb1b-9acbb7eb04db}","string":"System.String"}}},"FormatVersion":"1.0"}